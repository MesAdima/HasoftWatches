<!-- start: PAGE TITLE -->
<section id="page-title">
	<div class="row">
		<div class="col-sm-8">
			<h1 class="mainTitle" translate="sidebar.nav.pages.ADDPRODUCT">{{ mainTitle }}</h1>
			<span class="mainDescription">Upload a new product here</span>
		</div>
		<div ncy-breadcrumb></div>
	</div>
</section>
<!-- end: PAGE TITLE -->
<!-- Page Content -->
<div ng-controller="product">
	<div ng-controller="UploadCtrl" nv-file-drop="" uploader="uploaderImages">
		<!-- <div ng-controller="UploadCtrl2"> -->
		<div class="col-md-12">
			<div class="panel panel-white" id="panel1">
				<div class="container-fluid container-fullw">
					<div class="row">
						<div class="col-md-10">
							<div class="panel panel-white">
								<div class="panel-heading">
									<h5 class="panel-title">Product Information:</h5>
								</div>
								<div class="panel-body">
									<form role="form" id="thisone">
										<div class="form-group">
											<label for="pname">
												Product Name
											</label>
											<input type="text" class="form-control" id="pname" ng-model="product.name">
										</div>
										<div class="form-group">
											<label>
												Designer Category
											</label>
											
											<ui-select name="inData"   ng-model="product.category" theme="bootstrap" id="category" >
											<ui-select-match ng-click="selected.category_name"placeholder="Select category..">
											{{$select.selected.category_name}}
											</ui-select-match>
											<ui-select-choices  repeat="category._id as category in categories ">
											<span ng-bind-html="category.category_name"></span>
											</ui-select-choices>
											</ui-select>
										</div>
										<div class="form-group">
											<label>
												Sub Category
											</label>
											
											<ui-select name="inData"   ng-model="product.subcategory" theme="bootstrap" id="subcategory">
											<ui-select-match ng-click="selected.sub_category_name"placeholder="Select subcategory..">
											{{$select.selected.sub_category_name}}
											</ui-select-match>
											<ui-select-choices  repeat="subcategory._id as subcategory in subcategories ">
											<span ng-bind-html="subcategory.sub_category_name "></span>
											</ui-select-choices>
											</ui-select>
										</div>
										<div class="form-group">
											<label for="price">
												Product price (Ksh)
											</label>
											<input type="text" class="form-control" id="price" ng-model="product.price">
										</div>
										<div class="form-group">
											<span class="btn btn-primary btn-o btn-file"> Select an image file
												<input type="file" nv-file-select="on" uploader="uploaderImages" />
											</span>
										</div>
										<div class="file-upload" style="margin-bottom: 40px">
											<div class="table-responsive">
												<table class="table">
													<thead>
														<tr>
															<th width="50%">Name</th>
															<th ng-show="uploaderImages.isHTML5">Size</th>
															<th ng-show="uploaderImages.isHTML5">Progress</th>
															<th>Status</th>
															<th>Actions</th>
														</tr>
													</thead>
													<tbody>
														<tr ng-repeat="item in uploaderImages.queue">
															<td><strong>{{ item.file.name }}</strong>
																<!-- Image preview -->
																<!--auto height-->
																<!--<div ng-thumb="{ file: item.file, width: 100 }"></div>-->
																<!--auto width-->
																<div ng-show="uploaderImages.isHTML5" ng-thumb="{ file: item._file, height: 100 }"></div>
																<!--fixed width and height -->
																<!--<div ng-thumb="{ file: item.file, width: 100, height: 100 }"></div>-->
															</td>
															<td ng-show="uploaderImages.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td>
															<td ng-show="uploaderImages.isHTML5">
																<div class="progress progress-xs margin-bottom-0">
																	<div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
																</div></td>
																<td class="text-center"><span ng-show="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span><span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span><span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span></td>
																<td nowrap>
																	<button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
																	<span class="glyphicon glyphicon-trash"></span> Remove
																</button></td>
															</tr>
														</tbody>
													</table>
												</div>
												<div>
													<div>
														Queue progress:
														<div class="progress progress-xs margin-top-5 margin-bottom-20">
															<div class="progress-bar" role="progressbar" ng-style="{ 'width': uploaderImages.progress + '%' }"></div>
														</div>
													</div>
													<button type="button" class="btn btn-primary btn-s" ng-click="uploaderImages.uploadAll()" ng-disabled="!uploaderImages.getNotUploadedItems().length">
													<span class="glyphicon glyphicon-upload"></span> Upload image
													</button>
												</div>
											</div>
										</form>
										<button type="button" class="btn btn-o btn-wide btn-primary" id="newtest" >
										Save Product
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- </div> -->
	</div>
	<!-- End of Page Content -->

	<script >
	$("#newtest").click(function(){
		//e.preventDefault();
    //alert("Niko niko");return;
    //console.log('button fired');
     var formData = new FormData($("#thisone"));
     var name = $('#pname');
     var category = $('#category');
     var subcategory = $('#subcategory');
     var price = $('#price');
     $.ajax({
        
        url: 'http://localhost:81/haswatches/haswatches/assets/database/upload.php',

        data: {
        	'action' : 'add_product', 
        	'name' : name.val(), 
        	'categoryID' : category.val(), 
        	'subcategoryID': subcategory.val(), 
        	'price': price.val() 
        },
        dataType: 'json',
        type: 'POST',
         success: function (data) {
         	console.log(data);
           alert(data)
         },
      });
  });  
	</script>